# pip install tensorflow numpy

import numpy as np
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense

# Sample dataset (Sensor value vs Device state)
# 0 = Normal, 1 = Alert
X = np.array([[10],[20],[30],[40],[50],[60]])
y = np.array([0,0,0,1,1,1])

# Build lightweight model (good for edge)
model = Sequential([
    Dense(8, activation='relu', input_shape=(1,)),
    Dense(4, activation='relu'),
    Dense(1, activation='sigmoid')
])

# Compile
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Train
model.fit(X, y, epochs=50, verbose=1)

# Predict on edge device
prediction = model.predict([[45]])
print("Edge Device Prediction:", prediction[0][0])
